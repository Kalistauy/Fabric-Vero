get-token:
  name: Obtener token de Azure AD
  runs-on: ubuntu-latest
  outputs:
    access_token: ${{ steps.get_token.outputs.access_token }}
  steps:
    - name: Obtener token con client_credentials
      id: get_token
      run: |
        response=$(curl -X POST https://login.microsoftonline.com/${{ secrets.TENANT_ID }}/oauth2/v2.0/token \
          -H "Content-Type: application/x-www-form-urlencoded" \
          -d "client_id=${{ secrets.CLIENT_ID }}&scope=https%3A%2F%2Fapi.fabric.microsoft.com%2F.default&client_secret=${{ secrets.CLIENT_SECRET }}&grant_type=client_credentials")
        echo "access_token=$(echo $response | jq -r .access_token)" >> $GITHUB_OUTPUT
